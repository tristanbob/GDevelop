{
  "version": 3,
  "sources": ["../../../../../../../Extensions/Shopify/shopifytools.ts"],
  "sourcesContent": ["namespace gdjs {\n  export interface RuntimeGame {\n    shopifyClients: { [name: string]: any };\n  }\n  declare var ShopifyBuy: any;\n\n  export class ShopifyClientsManager {\n    static set(\n      instanceContainer: gdjs.RuntimeInstanceContainer,\n      name: string,\n      shopifyClient\n    ) {\n      const game = instanceContainer.getGame();\n      if (!game.shopifyClients) {\n        game.shopifyClients = {};\n      }\n      game.shopifyClients[name] = shopifyClient;\n    }\n\n    static get(instanceContainer: gdjs.RuntimeInstanceContainer, name: string) {\n      const game = instanceContainer.getGame();\n      if (!game.shopifyClients) {\n        game.shopifyClients = {};\n      }\n      return game.shopifyClients[name];\n    }\n  }\n\n  export namespace evtTools {\n    export namespace shopify {\n      export const buildClient = function (\n        instanceContainer: gdjs.RuntimeInstanceContainer,\n        name: string,\n        domain: string,\n        appId: string,\n        accessToken: string\n      ) {\n        if (typeof ShopifyBuy === 'undefined') {\n          return;\n        }\n        const config = new ShopifyBuy.Config({\n          accessToken: accessToken,\n          domain: domain,\n          appId: appId,\n        });\n        const shopifyClient = ShopifyBuy.buildClient(config);\n        ShopifyClientsManager.set(instanceContainer, name, shopifyClient);\n      };\n\n      export const getCheckoutUrlForProduct = function (\n        instanceContainer: gdjs.RuntimeInstanceContainer,\n        name: string,\n        productId: string,\n        quantity: number,\n        variantIndex: number,\n        successVariable: gdjs.Variable,\n        errorVariable: gdjs.Variable\n      ) {\n        errorVariable.setString('');\n        successVariable.setString('');\n        const shopifyClient = ShopifyClientsManager.get(\n          instanceContainer,\n          name\n        );\n        shopifyClient.fetchProduct(productId).then(\n          function (product) {\n            if (variantIndex < 0 || variantIndex >= product.variants.length) {\n              errorVariable.setString('The product has no variant.');\n              return;\n            }\n            const variant = product.variants[variantIndex];\n            const checkoutURL = variant.checkoutUrl(quantity);\n            successVariable.setString(checkoutURL);\n          },\n          function (error) {\n            errorVariable.setString(\n              'Unable to get the product that was requested.'\n            );\n          }\n        );\n      };\n    }\n  }\n}\n"],
  "mappings": "AAAA,GAAU,MAAV,UAAU,EAAV,CAMS,OAA4B,OAC1B,KACL,EACA,EACA,EACA,CACA,KAAM,GAAO,EAAkB,UAC/B,AAAK,EAAK,gBACR,GAAK,eAAiB,IAExB,EAAK,eAAe,GAAQ,QAGvB,KAAI,EAAkD,EAAc,CACzE,KAAM,GAAO,EAAkB,UAC/B,MAAK,GAAK,gBACR,GAAK,eAAiB,IAEjB,EAAK,eAAe,IAlBxB,EAAM,wBAsBN,GAAU,GAAV,UAAU,EAAV,CACE,GAAU,GAAV,UAAU,EAAV,CACE,AAAM,cAAc,SACzB,EACA,EACA,EACA,EACA,EACA,CACA,GAAI,MAAO,aAAe,YACxB,OAEF,KAAM,GAAS,GAAI,YAAW,OAAO,CACnC,YAAa,EACb,OAAQ,EACR,MAAO,IAEH,EAAgB,WAAW,YAAY,GAC7C,EAAsB,IAAI,EAAmB,EAAM,IAGxC,2BAA2B,SACtC,EACA,EACA,EACA,EACA,EACA,EACA,EACA,CACA,EAAc,UAAU,IACxB,EAAgB,UAAU,IAK1B,AAJsB,EAAsB,IAC1C,EACA,GAEY,aAAa,GAAW,KACpC,SAAU,EAAS,CACjB,GAAI,EAAe,GAAK,GAAgB,EAAQ,SAAS,OAAQ,CAC/D,EAAc,UAAU,+BACxB,OAGF,KAAM,GAAc,AADJ,EAAQ,SAAS,GACL,YAAY,GACxC,EAAgB,UAAU,IAE5B,SAAU,EAAO,CACf,EAAc,UACZ,sDA/CO,+BADF,iCA5BT",
  "names": []
}
